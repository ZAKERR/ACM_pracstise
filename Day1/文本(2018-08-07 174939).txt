#include<cstdio>#include<iostream>#include<cstring>using namespace std;typedef long long ll;ll a[1010101];ll multi(ll x,ll y,ll mod){	ll tmp=(x*y-(ll)((long double)x/mod*y+1.0e-8)*mod);	return tmp<0 ? tmp+mod : tmp;}int main(){	int t;	scanf("%d",&t);	while(t--)	{		int a0,a1,m0,m1,c,m,k;		scanf("%d%d%d%d%d%d%d",&a0,&a1,&m0,&m1,&c,&m,&k);		a[1]=a1;a[0]=a0;		//a[2]=muiti(m0,a1,m)+muiti(m1,a0,)		for(int i=2;i<=k;i++)		{			//a[i]=a[i-1]*m0+a[i-2]*m1+c;			a[i]=multi(a[i-1],m0,m)+multi(a[i-2],m1,m);			a[i]%=m;a[i]+=c;a[i]%=m;			//printf("%lld ",a[i]);		}		ll ans=1;		for(int i=0;i<=k;i++)		{			ans=multi(ans,a[i],m);		}		printf("%lld\n",ans);	}	return 0;}