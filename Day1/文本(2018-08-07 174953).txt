#include<cstdio>#include<iostream>#include<cstring>#include<algorithm>using namespace std;int n,t,m,a[100101],deng,pnt1,pnt2,p5,flag;bool cmp(int a,int b){	return a>b;}int main(){	scanf("%d",&t);	while(t--)	{		memset(a,0,sizeof(a));deng=0;p5=0;flag=0;		scanf("%d%d",&n,&m);		for(int i=1;i<=n;i++)		{			int x,y;			scanf("%d%d",&x,&y);			if(y==1)deng++;			a[i]=x;		}		int tmp=min(deng,m);		sort(a+1,a+1+n,cmp);		for(int i=1;i<=tmp;i++)		{			if(a[i]%2!=0)a[i]/=2,p5++;			else a[i]/=2;		}		long long ans=0;		for(int i=1;i<=n;i++)		{			ans+=a[i];		}		ans+=(p5/2);if(p5%2!=0)flag=1;		if(flag)printf("%lld.5\n",ans);		else printf("%lld.0\n",ans);	}	return 0;}